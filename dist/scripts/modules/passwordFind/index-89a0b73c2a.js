"use strict";angular.module("sbAdminApp").controller("password_findCtrl",["$scope","$rootScope","$interval","baseService",function(a,e,s,n){a.step=1,a.isSend=!1,a.countdown=60,a.data={email:"",yanz:"",newPassword1:"",newPassword:""},a.nextStep=function(){switch(a.step){case 1:a.mailForm.$valid?n.postData(n.api.apiUrl+"/client/user/checkResetPasswordCodeByEmail",{email:a.data.email,code:a.data.yanz},function(e){a.step+=1}):a.isShowMessage=!0;break;case 2:a.psd_form.$valid&&a.data.newPassword==a.data.newPassword1?n.postData(n.api.apiUrl+"/client/user/resetAdminPasswordByEmail",{email:a.data.email,code:a.data.yanz,newPassword:n.md5_pwd(a.data.newPassword)},function(){a.step+=1}):a.isShowMessage=!0}},a.sendYz=function(){if(!a.isSend)if(""!=a.data.email){var e=/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;if(e.test(a.data.email)){var t=s(function(){a.countdown<=0?(a.isSend=!1,a.countdown=60,s.cancel(t)):a.countdown--},1e3);n.getJson(n.api.apiUrl+"/client/user/getResetPasswordCode",{email:a.data.email},function(e){a.isSend=!0})}else n.alert("请输入正确邮箱","warning",!0)}else n.alert("请先输入邮箱","warning",!0)}}]);